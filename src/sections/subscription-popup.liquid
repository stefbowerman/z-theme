<div data-section-id="{{ section.id }}" data-section-type="subscription-popup" data-enabled="{{ section.settings.enabled }}">
  {% if settings.newsletter_form_action == blank %}
    <p style="color:red">A valid newsletter form action URL is required for this section.  Please go to <strong>General Settings -> Mailing List</strong> in the theme editor to add this information</p>
  {% endif %}
  <div class="subscription-popup">
    {% if section.settings.image %}
      <img src="{{ section.settings.image | img_url: '600x' }}" class="subscription-popup__image" />
    {% endif %}
    <form action="{{ settings.newsletter_form_action }}" method="post" data-subscription-popup-form>
      {% if section.settings.header_text != blank %}
        <h3>{{ section.settings.header_text }}</h3>
      {% endif %}
      {% if section.settings.body_text != blank %}
        <p>{{ section.settings.body_text }}</p>
      {% endif %}
      <input type="email" placeholder="{{ section.settings.placeholder_text }}" value="{% if customer %}{{ customer.email }}{% endif %}" required="required"/>
      <p>
        <input type="submit" name="submit" value="{{ section.settings.button_text }}">
      </p>
    </form>
    <div data-subscription-popup-success>
      <h3>
        {% if section.settings.success_message != blank %}
          {{ section.settings.success_message | escape | newline_to_br }}
        {% else %}
          Thank you for subscribing!
        {% endif %}
      </h3>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Subscription Popup",
    "settings": [
      {
        "type": "checkbox",
        "id": "enabled",
        "label": "Enabled?",
        "default": true
      },
      {
        "type": "text",
        "id": "seen_expiration",
        "label": "Days before showing again",
        "default": "30"
      },
      {
         "type": "header",
         "content": "Content"
      },
      {
        "type": "image_picker",
        "id": "image",
        "label": "Image"
      },
      {
        "type": "text",
        "id": "header_text",
        "label": "Header text"
      },
      {
        "type": "textarea",
        "id": "body_text",
        "label": "Body text"
      },
      {
        "type": "text",
        "id": "placeholder_text",
        "label": "Input placeholder text",
        "default": "Enter your email"
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Button text",
        "default": "Signup"
      },
      {
        "type": "textarea",
        "id": "success_message",
        "label": "Success Message",
        "info": "Text displayed when someone signs up successfully.  Leave blank for a generic message."
      }
    ]
  }
{% endschema %}